---
layout: post
title: mysql5.7源码安装
category : mysql
tagline: "Supporting tagline"
tags : [mysql]
---
{% include JB/setup %}
# mysql5.7源码安装
---

**1.安装依赖包**

```
yum -y install gcc-c++ ncurses-devel cmake make perl gcc autoconf automake zlib libxml libgcrypt libtool bison
```

**2.下载mysql源码包**

<a href='http://mirrors.sohu.com/mysql/MySQL-5.7/mysql-5.7.16.tar.gz' target='_blank'>mysql-5.7.16.tar.gz</a>

<!--break-->

**3.添加用户和组**

```
useradd mysql
groupadd -r -g mysql mysql -d /usr/local/mysql -s /sbin/nologin
```

**4.编译安装**

注：mysql5.7不建议使用mysql_install_db进行安装，估计后续版本会舍弃。

```
cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_UNIX_ADDR=/usr/local/mysql/mysql.sock -DSYSCONFDIR=/etc -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_ARCHIVE_STORAGE_ENGINE=1 -DWITH_BLACKHOLE_STORAGE_ENGINE=1 -DMYSQL_DATADIR=/usr/local/mysql/data -DMYSQL_TCP_PORT=3306 -DDOWNLOAD_BOOST=1 -DWITH_BOOST=/usr/local/include -DMYSQL_USER=mysql

make && make install

chown -R mysql:mysql /usr/local/mysql
```

```

**5.初始化数据库**

```
/usr/local/mysql/bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql --datadir=/usr/local/mysql/data
```

##注：初始化后会生成默认密码，请记录下来

```
2016-11-18T09:48:05.641072Z 1 [Note] A temporary password is generated for root@localhost: -1Dx>,>TzrNl
```

**5.修改配置**

```
cp /usr/local/mysql/support-files/my-default.cnf /etc/my.cnf
--修改basedir , datadir
```

```
cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql
chkconfig --add mysql
chkconfig mysql on
```

添加环境变量
```
vim /etc/profile
export MYSQL_HOME=/usr/local/mysql
export PATH=$PATH:$MYSQL_HOME/bin

source /etc/profile
```

```
service mysql start
```

```
alter user 'root'@'localhost' identified by '111';
FLUSH PRIVILEGES;

GRANT ALL PRIVILEGES ON *.* TO 'user3'@'192.168.155.1' IDENTIFIED BY '123456';
```